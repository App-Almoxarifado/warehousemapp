<div class="container mt-2">


    {{#each erros}}
    <div class="alert alert-danger">{{texto}}</div>
    {{else}}

    {{/each}}

    <form action="/products/products/newRequest" class="mt-2" method="POST">

        <div class="d-none">
            <div class="form-row">
                <input type="hidden" class="form-control mt-2" name="image" id="image" value="{{product.image}}">
                <div class="visible col-md-6">
                    <label for="group">Grupo:</label>
                    <select class=" custom-select" id="group" name="group" value="{{product.group}}"
                        onblur="viewCertificate(), statusCalibration()" required autofocus>
                        <option selected disabled value="">Selecione...</option>
                        {{#each groups}}
                        <option {{#if_eq ../product.group _id}}selected{{/if_eq}} value="{{_id}}">{{description}}
                        </option>
                        {{description}}
                        </option>
                        {{else}}
                        <option value="0">Nenhum group registrado</option>
                        {{/each}}
                    </select>
                </div>

                <div class="col-md-6">
                    <label for="subgroup">Subgrupo:</label>
                    <select class="custom-select" id="subgroup" name="subgroup" onchange="viewFile()"
                        value="{{product.subgroup}}">
                        <option selected disabled value="">Selecione...</option>
                        {{#each subgroups}}
                        <option {{#if_eq ../product.subgroup _id}}selected{{/if_eq}} value="{{_id}}">{{description}}
                        </option>
                        {{else}}
                        <option value="0">Nenhum Subgroup registrado</option>
                        {{/each}}
                    </select>
                </div>



                <div class="form-row">

                    <div class="form-group col-md-4">
                        <label for="requestOrigin
                        
                        ">Site:</label>
                        <select class="custom-select" id="requestOrigin" name="requestOrigin"
                            value="{{product.client}}">
                            <option selected disabled value="">Selecione...</option>
                            {{#each customers}}
                            <option {{#if_eq ../product.client _id}}selected{{/if_eq}} value="{{_id}}">{{description}}
                            </option>
                            {{else}}
                            <option value="0">Nenhum site registrado</option>
                            {{/each}}
                        </select>
                    </div>
                </div>

                <div class="form-group col-md-4">
                    <label for="local">Locação:</label>
                    <select class="custom-select" id="local" name="local" value="{{product.local}}">
                        <option selected disabled value="">Selecione...</option>
                        {{#each leases}}
                        <option {{#if_eq ../product.local _id}}selected{{/if_eq}} value="{{_id}}">{{description}}
                        </option>
                        {{else}}
                        <option value="0">Nenhuma locação registrada</option>
                        {{/each}}
                    </select>
                </div>

                <div class="form-group col-md-4">
                    <label for="sublease">Sublocação:</label>
                    <select class="custom-select" id="sublease" name="sublease" value="{{product.sublease}}">
                        <option selected disabled value="">Selecione...</option>
                        {{#each subleases}}
                        <option {{#if_eq ../product.sublease _id}}selected{{/if_eq}} value="{{_id}}">{{description}}
                        </option>
                        {{else}}
                        <option value="0">Nenhuma sublocação registrada</option>
                        {{/each}}
                    </select>
                </div>

            </div>

            <input type="hidden" class="form-control mt-2" name="fullDescription" id="fullDescription"
                placeholder="Descrição completa do Produto">

            <div class="form-row">
                <div class="form-group col-md-3">
                    <label for="patrimonialAsset">Bem Patrimonial:</label>
                    <input type="text" class="form-control" id="patrimonialAsset" name="patrimonialAsset"
                        placeholder="Bem Patrimonial" value="{{product.patrimonialAsset}}">
                </div>

                <div class="form-group col-md-9">
                    <label for="description">Descrição:</label>
                    <input type="text" class="form-control" id="description" name="description"
                        placeholder="Descrição do Produto" value="{{product.description}}">
                </div>

            </div>

            <div class="form-row">
                <div class="form-group col-md-3">
                    <label for="manufacturer">Fabricante:</label>
                    <input type="text" class="form-control" id="manufacturer" name="manufacturer"
                        placeholder="Fabricante do Produto" value="{{product.manufacturer}}">
                </div>

                <div class="form-group col-md-3">
                    <label for="model">Modelo:</label>
                    <input type="text" class="form-control" id="model" name="model" placeholder="Modelo do Produto"
                        value="{{product.model}}">
                </div>

                <div class="form-group col-md-4">
                    <label for="capacityReach">Capacidade / Alcance:</label>
                    <input type="text" class="form-control" id="capacityReach" name="capacityReach"
                        placeholder="Capacidade / Alcance do Produto" value="{{product.capacityReach}}">
                </div>

                <div class="form-group col-md-2">
                    <label for="serialNumber">N° de Série:</label>
                    <input type="text" class="form-control" id="serialNumber" name="serialNumber"
                        placeholder="N° de série do Produto" value="{{product.serialNumber}}">
                </div>

            </div>

            <div class="form-row">
                <div class="form-group col-md-4">
                    <label for="physicalStatus">Status:</label>
                    <select class="custom-select" id="physicalStatus" name="physicalStatus"
                        value="{{product.physicalStatus}}">
                        <option selected disabled value="">Selecione...</option>
                        {{#each status}}
                        <option {{#if_eq ../product.physicalStatus _id}}selected{{/if_eq}} value="{{_id}}">
                            {{description}}
                        </option>
                        {{else}}
                        <option value="0">Nenhum status registrado</option>
                        {{/each}}
                    </select>
                </div>

                <div class="form-group col-md-4">
                    <label for="kindOfEquipment">Tipo de Equipamento:</label>
                    <select class="custom-select" id="kindOfEquipment" name="kindOfEquipment"
                        value="{{product.kindOfEquipment}}">
                        <option selected disabled value="">Selecione...</option>
                        {{#each types}}
                        <option {{#if_eq ../product.kindOfEquipment _id}}selected{{/if_eq}} value="{{_id}}">
                            {{description}}
                        </option>
                        {{else}}
                        <option value="0">Nenhum tipo de equipamento registrado</option>
                        {{/each}}
                    </select>
                </div>

                <div class="form-group col-md-4">
                    <label for="requiresCertificationCalibration"> Requer Calibração/Certificação:</label>
                    <select class="custom-select" id="requiresCertificationCalibration"
                        name="requiresCertificationCalibration" onchange="viewCertificate()">
                        <option value="{{product.requiresCertificationCalibration}}" selected>
                            {{product.requiresCertificationCalibration}}

                        </option>
                        <option value="Sim">Sim</option>
                        <option value="Não">Não</option>
                    </select>
                </div>

            </div>


            <div class="form-row">
                <div class="form-group col-md-3">
                    <label for="unity">Unidade:</label>
                    <select class="custom-select" id="unity" name="unity" value="{{product.unity}}">
                        <option selected disabled value="">Selecione...</option>
                        {{#each units}}
                        <option {{#if_eq ../product.unity _id}}selected{{/if_eq}} value="{{_id}}">{{description}}
                        </option>
                        {{else}}
                        <option value="0">Nenhuma unidade de equipamento registrada</option>
                        {{/each}}
                    </select>
                </div>

                <div class="form-group col-md-3">
                    <label for="weightKg">Peso Kg:</label>
                    <input type="number" class="number form-control" id="weightKg" name="weightKg" step="0.01"
                        placeholder="Peso do Produto" value="{{product.weightKg}}">
                </div>

                <div class="form-group col-md-3">
                    <label for="faceValue">Valor de Face:</label>
                    <input type="number" class="number form-control" id="faceValue" name="faceValue"
                        placeholder="Valor do Produto" step="0.01" value="{{product.faceValue}}">
                </div>

                <div class="form-group col-md-3">
                    <label for="dimensionsWxLxH">Dimensões LxCxA mm:</label>
                    <input type="text" class="form-control" id="dimensionsWxLxH" name="dimensionsWxLxH"
                        placeholder="Dimensões do Produto" value="{{product.dimensionsWxLxH}}">
                </div>
            </div>


            <div class="certificate">
                <div class="form-row">

                    <div class="form-group col-md-2">
                        <label for="certificate">Certificado:</label>
                        <input type="text" class="form-control" id="certificate" name="certificate"
                            placeholder="Certificado do Produto" value="{{product.certificate}}">
                    </div>

                    <div class="form-group col-md-2">
                        <label for="entityLaboratory">Laboratório/ Entidade:</label>
                        <input type="text" class="form-control" id="entityLaboratory" name="entityLaboratory"
                            placeholder="Laboratório/ Entidade" value="{{product.entityLaboratory}}">
                    </div>

                    <div class="form-group col-md-2">
                        <label for="calibrationDate">Data Calibração:</label>
                        <input type="date" class="form-control" id="calibrationDate" name="calibrationDate"
                            placeholder="Data Calibração" value="{{product.calibrationDate}}" onchange="calculater();">
                    </div>

                    <div class="form-group col-md-2">
                        <label for="frequency">Periodicidade:</label>
                        <select class="custom-select" id="frequency" name="frequency" value="{{product.frequency}}"
                            onchange="calculater();">
                            <option selected disabled value="">Selecione...</option>
                            {{#each breaks}}
                            <option {{#if_eq ../product.frequency _id}}selected{{/if_eq}} value="{{_id}}">
                                {{description}}
                            </option>
                            {{else}}
                            <option value="0">Nenhum intervalo registrado</option>
                            {{/each}}
                        </select>
                    </div>

                    <div class="form-group col-md-2">
                        <label for="calibrationValidity">Validade Calibração:</label>
                        <input type="date" class="form-control" id="calibrationValidity" name="calibrationValidity"
                            placeholder="Validade Calibração" value="{{product.calibrationValidity}}">
                    </div>

                    <div class="form-group col-md-2">
                        <label for="calibrationStatus">Status Calibração:</label>
                        <input type="text" class="form-control" id="calibrationStatus" name="calibrationStatus"
                            placeholder="Status Calibração" value="{{product.calibrationStatus}}">
                    </div>

                </div>

            </div>

            <div class="form-row">

                <div class="form-group col-md-2">
                    <label for="po">P.O.:</label>
                    <input type="text" class="form-control" id="po" name="po" placeholder="P.O. do Produto"
                        value="{{product.po}}">
                </div>

                <div class="form-group col-md-2">
                    <label for="sapCode">Código Sap:</label>
                    <input type="text" class="form-control" id="sapCode" name="sapCode" placeholder="Código Sap"
                        value="{{product.sapCode}}">
                </div>

                <div class="form-group col-md-2">
                    <label for="ncmCode">Código Ncm:</label>
                    <input type="text" class="form-control" id="ncmCode" name="ncmCode" placeholder="Código Ncm"
                        value="{{product.ncmCode}}">
                </div>

                <div class="form-group col-md-2">
                    <label for="provider">Fornecedor:</label>
                    <select class="custom-select" id="provider" name="provider" value="{{product.provider}}">
                        <option selected disabled value="">Selecione...</option>
                        {{#each providers}}
                        <option {{#if_eq ../product.provider _id}}selected{{/if_eq}} value="{{_id}}">{{name}}
                        </option>
                        {{else}}
                        <option value="0">Nenhum Fornecedor registrado</option>
                        {{/each}}
                    </select>
                </div>

                <div class="form-group col-md-2">
                    <label for="invoce">Nota Fiscal:</label>
                    <input type="text" class="form-control" id="invoce" name="invoce" placeholder="Nota Fiscal"
                        value="{{product.provider}}">
                </div>

                <div class="form-group col-md-2">
                    <label for="receivingDate">Data Recebimento:</label>
                    <input type="date" class="form-control" id="receivingDate" name="receivingDate"
                        placeholder="Data Recebimento" value="{{product.receivingDate}}">
                </div>

            </div>

            <div class="form-row">
                <div class="form-group col-md-12">
                    <label for="note">Observações:</label>
                    <input type="text" class="form-control" id="note" name="note"
                        placeholder="Observações sobre o produto" value="{{product.note}}">
                </div>
            </div>
            <input type="hidden" class="form-control" id="requestUser" name="requestUser" placeholder="Pedido Usuário"
                value="{{user.nome}}">
            <input type="hidden" class="form-control" id="responsibleSite" name="responsibleSite"
                placeholder="Responsável Site" value="{{user.nome}}">
            <input type="hidden" class="form-control mt-2" name="activeStatus" id="activeStatus">
            <input type="hidden" class="form-control mt-2" id="releaseDateOf" name="releaseDateOf" placeholder="date"
                value="{{#formatDate date}}{{/formatDate}}">
            <input type="hidden" class="form-control mt-2" name="userLaunch" id="userLaunch" value="{{user.nome}}">
            <input type="hidden" class="form-control mt-2" name="emailLaunch" id="emailLaunch" value="{{user.email}}">
            <input type="hidden" class="form-control mt-2" id="editionDate" name="editionDate" placeholder="date"
                value="{{#formatDate date}}{{/formatDate}}">
            <input type="hidden" class="form-control mt-2" name="userEdtion" id="userEdtion" value="{{user.nome}}">
            <input type="hidden" class="form-control mt-2" name="emailEdtion" id="emailEdtion" value="{{user.email}}">

            <div class="form-group col-md-8">
                <div class="form-row">
                    <button type="submit" class="btn btn-success">Salvar <i class="fas fa-share"></i></button>
                </div>
            </div>
        </div>






        <div class="card" style="background-color: transparent;">
            <div class="card-body">
                <h3>{{product.fullDescription}}</h3>
                <hr>
                <div class="row no-gutters position-relative">
                    <div class="col-12  col-md-4 mb-md-0 p-md-0 text-center">
                        <img src="{{product.image}}" style="width: 10rem;" class="rounded mr-0" alt="...">
                    </div>
                    <div class="col-12 d-none d-md-block col-md-3 mb-md-0 p-md-0 text-center">
                        <img id="qrcode" name="qrcode"
                            src="https://chart.googleapis.com/chart?chs=500x500&cht=qr&chl={{product.qrcode}}"
                            style="width: 10rem;" class="rounded mr-0">
                    </div>


                    <div class=" col-md-5 position-static p-0 pl-md-0 text-center">

                        <div class="mt-2 form-group row">
                            <label for="client" class="col-sm-4 col-form-label">Site Solicitante:</label>
                            <div class="col-sm-8">
                                <select class="custom-select" id="client" name="client" required>
                                    <option selected disabled value="">Selecione...</option>
                                    {{#each customers}}
                                    <option value="{{_id}}">{{description}}</option>
                                    {{else}}
                                    <option value="0">Nenhum site registrado</option>
                                    {{/each}}
                                </select>
                            </div>
                        </div>

                        
                            
                            <div class="col-6 col-sm-3 mt-1">
                                <input type="hidden" class="form-control" id="inputAmount" name="inputAmount"
                                    value="{{product.inputAmount}}" onfocus="stock()">
                            </div>
                        <div class="form-group row">
                            <label for="outputQuantity" class="col-6 col-sm-3 mt-1 col-form-label">Quantidade:</label>
                            <div class="col-6 col-sm-3 mt-1">
                                <input type="number" class="form-control" id="outputQuantity" name="outputQuantity"
                                    value="1" onkeyup="stock()" onchange="stock()">
                            </div>

                            <label for="stockQuantity" class="col-6  col-sm-3 mt-1 col-form-label">Disponível:</label>
                            <div class="col-6 col-sm-3 mt-1">
                                <input type="number" class="car form-control" id="stockQuantity" name="stockQuantity"id="stockQuantity" name="stockQuantity"
                                    step="0.01" value="{{product.stockQuantity}}">
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-6 mt-1">
                                <a href="/products/products" class="btn btn-secondary btn-lg btn-block"
                                    data-toggle="tooltip" data-placement="bottom" title="Visualizar detalhes">
                                    <h6>Voltar ao Dashboard</h6>
                                </a>
                            </div>
                            <div class="col-sm-6 mt-1">
                                <button type="submit" class="btn btn-primary btn-lg btn-block">
                                    <h6>Fazer Pedido</h6>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="row no-gutters position-relative">
                    <div class="col-md-4 position-static p-0 pl-md-0 text-center">
                        <select class="car form-control" value="{{product.group}}">
                            <option selected disabled value="">Selecione...</option>
                            {{#each groups}}
                            <option {{#if_eq ../product.group _id}}selected{{/if_eq}} value="{{_id}}">
                                Grupo: {{description}}
                            </option>
                            {{description}}
                            </option>
                            {{else}}
                            <option value="0">Nenhum grupo registrado</option>
                            {{/each}}
                        </select>

                        <select class="car form-control" value="{{product.group}}">
                            <option selected disabled value="">Selecione...</option>
                            {{#each subgroups}}
                            <option {{#if_eq ../product.subgroup _id}}selected{{/if_eq}} value="{{_id}}">
                                Subgrupo: {{description}}
                            </option>
                            {{description}}
                            </option>
                            {{else}}
                            <option value="0">Nenhum subgrupo registrado</option>
                            {{/each}}
                        </select>

                        <select class="car form-control" value="{{product.client}}">
                            <option selected disabled value="">Selecione...</option>
                            {{#each customers}}
                            <option {{#if_eq ../product.client _id}}selected{{/if_eq}} value="{{_id}}">
                                Site: {{description}}
                            </option>
                            {{description}}
                            </option>
                            {{else}}
                            <option value="0">Nenhum site registrado</option>
                            {{/each}}
                        </select>

                        <select class="car form-control" value="{{product.local}}">
                            <option selected disabled value="">Selecione...</option>
                            {{#each leases}}
                            <option {{#if_eq ../product.local _id}}selected{{/if_eq}} value="{{_id}}">
                                Locação: {{description}}
                            </option>
                            {{description}}
                            </option>
                            {{else}}
                            <option value="0">Nenhuma locação registrada</option>
                            {{/each}}
                        </select>

                        <select class="car form-control" value="{{product.sublease}}">
                            <option selected disabled value="">Selecione...</option>
                            {{#each subleases}}
                            <option {{#if_eq ../product.sublease _id}}selected{{/if_eq}} value="{{_id}}">
                                Sublocação: {{description}}
                            </option>
                            {{description}}
                            </option>
                            {{else}}
                            <option value="0">Nenhuma sublocação registrada</option>
                            {{/each}}
                        </select>

                        <input type="text" class="car form-control" placeholder="Patrimônio"
                            value="Patrimônio: {{product.activeStatus}}">
                    </div>

                    <div class="col-md-4 position-static p-0 pl-md-0 text-center">
                        <input type="text" class="car form-control" placeholder="Bem Patrimonial"
                            value="Bem patrimonial: {{product.patrimonialAsset}}">

                        <input type="text" class="car form-control" placeholder="Descrição"
                            value="Descrição: {{product.description}}">

                        <input type="text" class="car form-control" placeholder="Fabricante"
                            value="Fabricante: {{product.manufacturer}}">

                        <input type="text" class="car form-control" placeholder="Modelo"
                            value="Modelo: {{product.model}}">

                        <input type="text" class="car form-control" placeholder="Capacidade / Alacance"
                            value="Capacidade/ Alcance: {{product.capacityReach}}">

                        <input type="text" class="car form-control" placeholder="Número de Série"
                            value="Número de Série: {{product.serialNumber}}">
                    </div>

                    <div class="col-md-4 position-static p-0 pl-md-0 text-center">
                        <select class="car form-control" value="{{product.physicalStatus}}">
                            <option selected disabled value="">Selecione...</option>
                            {{#each status}}
                            <option {{#if_eq ../product.physicalStatus _id}}selected{{/if_eq}} value="{{_id}}">
                                Status Físico: {{description}}
                            </option>
                            {{description}}
                            </option>
                            {{else}}
                            <option value="0">Nenhum status registrado</option>
                            {{/each}}
                        </select>

                        <select class="car form-control" value="{{product.kindOfEquipment}}">
                            <option selected disabled value="">Selecione...</option>
                            {{#each types}}
                            <option {{#if_eq ../product.kindOfEquipment _id}}selected{{/if_eq}} value="{{_id}}">
                                Tipo de equipamento: {{description}}
                            </option>
                            {{description}}
                            </option>
                            {{else}}
                            <option value="0">Nenhum tipo registrado</option>
                            {{/each}}
                        </select>

                        <input type="text" class="car form-control" placeholder="Requer calibração / certificação"
                            value="Requer calibração / certificação: {{product.requiresCertificationCalibration}}">

                        <input type="text" class="car form-control" placeholder="Peso Kg"
                            value="Peso: {{product.weightKg}} Kg">

                        <input type="text" class="car form-control" placeholder="Valor de fece"
                            value="Valor de fece: R${{product.faceValue}}">

                        <input type="text" class="car form-control" placeholder="Dimensões l x C x A"
                            value="Dimensões L x C x A mm: {{product.dimensionsWxLxH}}">
                    </div>
                    <div class="col-md-4 position-static p-0 pl-md-0 text-center">
                        <select class="car form-control" value="{{product.provider}}">
                            <option selected disabled value="">Selecione...</option>
                            {{#each providers}}
                            <option {{#if_eq ../product.provider _id}}selected{{/if_eq}} value="{{_id}}">
                                Fornecedor: {{name}}
                            </option>
                            {{name}}
                            </option>
                            {{else}}
                            <option value="0">Nenhum fornecedor registrado</option>
                            {{/each}}
                        </select>

                        <input type="text" class="car form-control" placeholder="Nota Fiscal"
                            value="Nota Fiscal: {{product.invoce}}">

                        <input type="text" class="car form-control" placeholder="Data de recebimento"
                            value="Data de recebimento: {{product.receivingDate}}">

                        <input type="text" class="car form-control" placeholder="PO" value="Po: {{product.po}}">

                        <input type="text" class="car form-control" placeholder="Quantidade entrada"
                            value="Quantidade entrada: {{product.inputAmount}}">

                        <select class="car form-control" value="{{product.unity}}">
                            <option selected disabled value="">Selecione...</option>
                            {{#each units}}
                            <option {{#if_eq ../product.unity _id}}selected{{/if_eq}} value="{{_id}}">
                                Unidade: {{description}}
                            </option>
                            {{description}}
                            </option>
                            {{else}}
                            <option value="0">Nenhum fornecedor registrado</option>
                            {{/each}}
                        </select>
                    </div>
                    <div class="col-md-4 position-static p-0 pl-md-0 text-center">
                        <input type="text" class="car form-control" placeholder="Certificado"
                            value="Certificado: {{product.certificate}}">

                        <input type="text" class="car form-control" placeholder="Entidade / Laboratório"
                            value="Entidade / Laboratório: {{product.entityLaboratory}}">

                        <select class="car form-control" value="{{product.frequency}}">
                            <option selected disabled value="">Selecione...</option>
                            {{#each breaks}}
                            <option {{#if_eq ../product.frequency _id}}selected{{/if_eq}} value="{{_id}}">
                                Periodicidade: {{description}}
                            </option>
                            {{description}}
                            </option>
                            {{else}}
                            <option value="0">Nenhum fornecedor registrado</option>
                            {{/each}}
                        </select>

                        <input type="text" class="car form-control" placeholder="Data de Calibração"
                            value="Data de Calibração: {{product.calibrationDate}}">

                        <input type="text" class="car form-control" placeholder="Validade Calibração"
                            value="Validade Calibração: {{product.calibrationValidity}}">

                        <input type="text" class="car form-control" placeholder="Status Calibração"
                            value="Status Calibração: {{product.calibrationStatus}}">
                    </div>

                    <div class="col-md-4 position-static p-0 pl-md-0 text-center">
                        <input type="text" class="car form-control" placeholder="Código Sap"
                            value="Código Sap: {{product.sapCode}}">

                        <input type="text" class="car form-control" placeholder="Código Ncm"
                            value="Código Ncm: {{product.ncmCode}}">

                        <input type="text" class="car form-control" placeholder="Usuário Lançamento"
                            value="Usuário Lançamento: {{product.userLaunch}}">

                        <input type="text" class="car form-control" placeholder="Data Lançamento"
                            value="Data Lançamento: {{product.releaseDateOf}}">

                        <input type="text" class="car form-control" placeholder="Ultima Movimentação"
                            value="Ultima Movimentação: {{product.editionDate}}">

                        <input type="text" class="car form-control" placeholder="Renponsável pelo Material"
                            value="Responsável pelo Material: {{product.userEdtion}}">
                    </div>
                </div>
                <div class="row no-gutters position-relative">
                    <div class="col-md-12 position-static p-0 pl-md-0 text-center">
                        <input type="text" class="car form-control" placeholder="Renponsável pelo Material"
                            value="Observação: {{product.note}}">
                    </div>
                </div>
            </div>
    </form>
</div>

<div class="mt-2"></div>